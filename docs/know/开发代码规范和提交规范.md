---
sidebar:
 title: å¼€å‘ä»£ç è§„èŒƒå’Œgitæäº¤æ£€æµ‹
 step: 1
 isTimeLine: true
title: å¼€å‘ä»£ç è§„èŒƒå’Œgitæäº¤æ£€æµ‹
tags:
 - ä¸æ‡‚çš„çŸ¥è¯†
categories:
 - ä¸æ‡‚çš„çŸ¥è¯†
---


# å¼€å‘ä»£ç è§„èŒƒå’Œgitæäº¤æ£€æµ‹

## ä»£ç è§„èŒƒ

### ä»£ç æ£€æŸ¥å·¥å…·

- **ESlint**
- é…ç½®æ–‡ä»¶: **.eslintrc.js**
- å¿½ç•¥æ–‡ä»¶: .eslintignore

### ä»£ç é£æ ¼å·¥å…·

- **prettier**
- é…ç½®æ–‡ä»¶: .prettierrc.js

## ESlintæ£€æŸ¥

å…ˆåˆ›å»ºä¸€ä¸ªvue3+viteçš„é¡¹ç›®

```shell
yarn create vite my-vue-app --template vue
```

åˆ›å»ºå®Œæˆå,ä½¿ç”¨`ESlint`è¿›è¡Œä»£ç æ£€æŸ¥

[ESlintå®˜æ–¹æ–‡æ¡£](https://eslint.bootcss.com/)

ç„¶åå®‰è£…ESlint(å…¨å±€å®‰è£…ä¸€ä¸‹)

```shell
yarn add eslint -g
```

eslintåˆå§‹åŒ–å‘½ä»¤

```shell
npx eslint --init
```

æ‰§è¡Œå®Œæ¯•åå‡ºç°

```shell
(1) How would you like to use ESLint?
é€‰æ‹©ï¼šTo check syntax and find problems

(2) What type of modules does your project use?
é€‰æ‹©ï¼šJavaScript modules (import/export)

(3) Which framework does your project use?
é€‰æ‹©ï¼šVue.js

(4) Does your project use TypeScript?
é€‰æ‹©ï¼šYes

(5) Where does your code run?
é€‰æ‹©ï¼šBrowser

(6) What format do you want your config file to be in?
é€‰æ‹©ï¼šJavaScript

(7) Would you like to install them now?
é€‰æ‹©ï¼šYes

(8) Which package manager do you want to use?
é€‰æ‹©ï¼šyarn
```

### ä¾èµ–å®‰è£…å®Œæˆåï¼Œä¼šç”Ÿæˆ`.eslintrc.js`é…ç½®æ–‡ä»¶

```js
module.exports = {
  env: {
    browser: true,
    es2021: true
  },
  extends: ['eslint:recommended', 'plugin:vue/vue3-essential', 'plugin:@typescript-eslint/recommended'],
  overrides: [],
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module'
  },
  plugins: ['vue', '@typescript-eslint'],
  rules: {}
}

```

### åœ¨`package.json`æ–‡ä»¶ä¸­çš„`script`ä¸­æ·»åŠ `lint`å‘½ä»¤

```js
{
    "scripts": {
        // eslint . ä¸ºæŒ‡å®šlintå½“å‰é¡¹ç›®ä¸­çš„æ–‡ä»¶
        // --ext ä¸ºæŒ‡å®šlintå“ªäº›åç¼€çš„æ–‡ä»¶
        // --fix å¼€å¯è‡ªåŠ¨ä¿®å¤
        "lint": "eslint . --ext .vue,.js,.ts,.jsx,.tsx --fix"
    }
}

```

### æ‰§è¡Œ`lint`å‘½ä»¤

```shell
yarn lint
```



<img src="./assets/image-20221002172639694.png" alt="image-20221002172639694" style="zoom:50%;" />



å‡ºç°äº†æ²¡æœ‰æ‰¾åˆ°`typescript`æ¨¡å—,å®‰è£…ä¸€ä¸‹

```shell
yarn add typescript -D
```

å†æ¬¡æ‰§è¡Œ`yarn lint`å‘½ä»¤

<img src="./assets/image-20221002172935463.png" alt="image-20221002172935463" style="zoom:50%;" />

ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯, è§£æ`.vue`åç¼€çš„æ–‡ä»¶æ—¶å€™å‡ºç°è§£æé”™è¯¯`parsing error`

`eslint`é»˜è®¤æ˜¯ä¸ä¼šè§£æ`.vue`åç¼€æ–‡ä»¶çš„ã€‚å› æ­¤ï¼Œéœ€è¦ä¸€ä¸ªé¢å¤–çš„è§£æå™¨æ¥è§£æ`.vue`åç¼€æ–‡ä»¶ã€‚

ä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹`.eslintrc.js`æ–‡ä»¶ä¸­çš„`extends`ä¼šå‘ç°å·²ç»æœ‰ç»§æ‰¿`"plugin:vue/vue3-essential"`çš„é…ç½®ã€‚ç„¶ååœ¨`node_modules`ä¸­å¯ä»¥æ‰¾åˆ°`eslint-plugin-vue/lib/cinfigs/essential`ï¼Œé‡Œé¢é…ç½®äº†`extends`æ˜¯ç»§æ‰¿äºåŒçº§ç›®å½•ä¸‹çš„`base.js`ï¼Œåœ¨é‡Œé¢ä¼šå‘ç°`parser: require.resolve('vue-eslint-parser')`è¿™ä¸ªé…ç½®ã€‚å› æ­¤ï¼ŒæŒ‰é“ç†æ¥è¯´åº”è¯¥æ˜¯ä¼šè§£æ`.vue`åç¼€æ–‡ä»¶çš„ã€‚

ç»§ç»­å¾€ä¸‹çœ‹`.eslintrc.js`æ–‡ä»¶ä¸­çš„`extends`ä¼šå‘ç°ï¼Œ`extends`ä¸­è¿˜æœ‰ä¸€ä¸ª`"plugin:@typescript-eslint/recommended"`ï¼Œå®ƒæ˜¯æ¥è‡ªäº`/node_modules/@typescript-eslint/eslint-plugin/dist/configs/recommended.js`ï¼ŒæŸ¥çœ‹è¯¥æ–‡ä»¶ä¼šå‘ç°æœ€ç»ˆç»§æ‰¿äºåŒçº§ç›®å½•ä¸‹çš„`base.js`æ–‡ä»¶ã€‚ä»è¯¥æ–‡ä»¶ä¸­å¯ä»¥å‘ç°`parser: '@typescript-eslint/parser',`é…ç½®ã€‚

æŒ‰ç…§`.eslintrc.js`æ–‡ä»¶ä¸­çš„`extends`é…ç½®çš„é¡ºåºå¯çŸ¥ï¼Œæœ€ç»ˆå¯¼è‡´æŠ¥é”™çš„åŸå› å°±æ˜¯`@typescript-eslint/parser`æŠŠ`vue-eslint-parser`è¦†ç›–äº†ã€‚

```shell
{
    "extends": [
        "eslint:recommended",
        "plugin:vue/vue3-essential",
        "plugin:@typescript-eslint/recommended"
    ],
}
```

æŸ¥çœ‹[eslint-plugin-vue](https://link.juejin.cn?target=https%3A%2F%2Feslint.vuejs.org%2Fuser-guide%2F%23faq)å®˜æ–¹æ–‡æ¡£å¯çŸ¥ã€‚å¦‚æœå·²ç»ä½¿ç”¨äº†å¦å¤–çš„è§£æå™¨ï¼ˆä¾‹å¦‚`"parser": "@typescript-eslint/parser"`ï¼‰ï¼Œåˆ™éœ€è¦å°†å…¶ç§»è‡³`parseOptions`ï¼Œè¿™æ ·æ‰ä¸ä¼šä¸`vue-eslint-parser`å†²çªã€‚



ä¿®æ”¹`.eslintrc.js`æ–‡ä»¶

```js
module.exports = {
    "env": {
        "browser": true,
        "es2021": true,
        "node": true
    },
    "extends": [
        "eslint:recommended",
        "plugin:vue/vue3-essential",
        "plugin:@typescript-eslint/recommended"
    ],
    "parser": "vue-eslint-parser",
    "parserOptions": {
        "ecmaVersion": "latest",
        "parser": "@typescript-eslint/parser", // æ–°å¢
        "sourceType": "module"
    },
    "plugins": [
        "vue",
        "@typescript-eslint"
    ],
    "rules": {
    }
}
```

ä¸¤ä¸ª`parser`çš„åŒºåˆ«åœ¨äºï¼Œå¤–é¢çš„`parser`ç”¨æ¥è§£æ`.vue`åç¼€æ–‡ä»¶ï¼Œä½¿å¾—`eslint`èƒ½è§£æ`<template>`æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œè€Œ`parserOptions`ä¸­çš„`parser`ï¼Œå³`@typescript-eslint/parser`ç”¨æ¥è§£ævueæ–‡ä»¶ä¸­`<script>`æ ‡ç­¾ä¸­çš„ä»£ç ã€‚

æ­¤æ—¶ï¼Œå†æ‰§è¡Œ` yarn lint`ï¼Œå°±ä¼šå‘ç°æ ¡éªŒé€šè¿‡äº†ã€‚

### å®‰è£…vscodeæ’ä»¶ESLint

å¦‚æœå†™ä¸€è¡Œä»£ç å°±è¦æ‰§è¡Œä¸€é`lint`å‘½ä»¤ï¼Œè¿™æ•ˆç‡å°±å¤ªä½äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é…åˆvscodeçš„`ESLint`æ’ä»¶ï¼Œå®ç°æ¯æ¬¡ä¿å­˜ä»£ç æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œ`lint`å‘½ä»¤æ¥ä¿®å¤ä»£ç çš„é”™è¯¯ã€‚

åœ¨é¡¹ç›®ä¸­æ–°å»º`.vscode/settings.json`æ–‡ä»¶ï¼Œç„¶ååœ¨å…¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ã€‚

```json
{
    // å¼€å¯è‡ªåŠ¨ä¿®å¤
    "editor.codeActionsOnSave": {
        "source.fixAll": false,
        "source.fixAll.eslint": true
    }
}
```

### æµ‹è¯•ESlintæ’ä»¶

æ‰§è¡Œå¯åŠ¨å‘½ä»¤

```shell
yarn dev
```

.eslintrc.cjsä¸­åŠ å…¥è§„åˆ™

```js
rules: {
    // ç¦æ­¢ä¸å¿…è¦çš„åˆ†å·
    'no-extra-semi': 2,
    // çœç•¥...
}
```

![image-20221002205913227](./assets/image-20221002205913227.png)

### å®‰è£…ä¾èµ–è¯´æ˜

- [eslint](https://link.juejin.cn/?target=https%3A%2F%2Fcn.eslint.org%2F)ï¼š JavaScript å’Œ JSX æ£€æŸ¥å·¥å…·
- [eslint-plugin-vue](https://link.juejin.cn/?target=https%3A%2F%2Feslint.vuejs.org%2F)ï¼š ä½¿ç”¨ ESLint æ£€æŸ¥ .vueæ–‡ä»¶ çš„ `<template>` å’Œ `<script>`ï¼Œä»¥åŠ`.js`æ–‡ä»¶ä¸­çš„Vueä»£ç 



## é…ç½®prettier

å®‰è£…

```shell
yarn add prettier -D
```

### åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º`.prettierrc.js`

æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œæ›´å¤šé…ç½®å¯æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://link.juejin.cn/?target=https%3A%2F%2Fprettier.io%2Fdocs%2Fen%2Foptions.html)

```js
module.exports = {
    // ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œï¼Œé»˜è®¤ä¸º80
    printWidth: 80, 
    // ä¸€ä¸ªtabä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°ï¼Œé»˜è®¤ä¸º80
    tabWidth: 2, 
    // æ˜¯å¦ä½¿ç”¨tabè¿›è¡Œç¼©è¿›ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºç”¨ç©ºæ ¼è¿›è¡Œç¼©å‡
    useTabs: false, 
    // å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·ï¼Œé»˜è®¤ä¸ºfalseï¼Œä½¿ç”¨åŒå¼•å·
    singleQuote: true, 
    // è¡Œä½æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue
    semi: false, 
    // æ˜¯å¦ä½¿ç”¨å°¾é€—å·ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼"<none|es5|all>"
    trailingComma: "none", 
    // å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸ºtrueï¼Œæ•ˆæœï¼š{ foo: bar }
    bracketSpacing: true
}
```

### åœ¨`package.json`ä¸­çš„`script`ä¸­æ·»åŠ ä»¥ä¸‹å‘½ä»¤

```json
{
    "scripts": {
        "format": "prettier --write \"./**/*.{html,vue,ts,js,json,md}\"",
    }
}
```

è¿è¡Œè¯¥å‘½ä»¤ï¼Œä¼šå°†æˆ‘ä»¬é¡¹ç›®ä¸­çš„æ–‡ä»¶éƒ½æ ¼å¼åŒ–ä¸€éï¼Œ**åç»­å¦‚æœæ·»åŠ å…¶ä»–æ ¼å¼çš„æ–‡ä»¶ï¼Œå¯åœ¨è¯¥å‘½ä»¤ä¸­æ·»åŠ ï¼Œä¾‹å¦‚ï¼š`.less`åç¼€çš„æ–‡ä»¶**

### å®‰è£…vscodeçš„Prettier - Code formatteræ’ä»¶

å®‰è£…è¯¥æ’ä»¶çš„ç›®çš„æ˜¯ï¼Œè®©è¯¥æ’ä»¶åœ¨æˆ‘ä»¬ä¿å­˜çš„æ—¶å€™è‡ªåŠ¨å®Œæˆæ ¼å¼åŒ–

åœ¨`.vscode/settings.json`ä¸­æ·»åŠ ä¸€ä¸‹è§„åˆ™

```js
{
    // ä¿å­˜çš„æ—¶å€™è‡ªåŠ¨æ ¼å¼åŒ–
    "editor.formatOnSave": true,
    // é»˜è®¤æ ¼å¼åŒ–å·¥å…·é€‰æ‹©prettier
    "editor.defaultFormatter": "esbenp.prettier-vscode"
}
```



## è§£å†³`eslint`ä¸`prettier`çš„å†²çª

åœ¨ç†æƒ³çš„çŠ¶æ€ä¸‹ï¼Œ`eslint`ä¸`prettier`åº”è¯¥å„å¸å…¶èŒã€‚`eslint`è´Ÿè´£æˆ‘ä»¬çš„ä»£ç è´¨é‡ï¼Œ`prettier`è´Ÿè´£æˆ‘ä»¬çš„ä»£ç æ ¼å¼ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œç”±äºæˆ‘ä»¬å¼€å¯äº†è‡ªåŠ¨åŒ–çš„`eslint`ä¿®å¤ä¸è‡ªåŠ¨åŒ–çš„æ ¹æ®`prettier`æ¥æ ¼å¼åŒ–ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬å·²ä¿å­˜ä»£ç ï¼Œä¼šå‡ºç°å±å¹•é—ªä¸€èµ·ååˆæ¢å¤åˆ°äº†æŠ¥é”™çš„çŠ¶æ€ã€‚

è¿™å…¶ä¸­çš„æ ¹æœ¬åŸå› å°±æ˜¯`eslint`æœ‰éƒ¨åˆ†è§„åˆ™ä¸`prettier`å†²çªäº†ï¼Œæ‰€ä»¥ä¿å­˜çš„æ—¶å€™æ˜¾ç¤ºè¿è¡Œäº†`eslint`çš„ä¿®å¤å‘½ä»¤ï¼Œç„¶åå†è¿è¡Œ`prettier`æ ¼å¼åŒ–ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°å±å¹•é—ªä¸€ä¸‹ç„¶ååˆæ¢å¤åˆ°æŠ¥é”™çš„ç°è±¡ã€‚è¿™æ—¶å€™ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å†²çªçš„è§„åˆ™ã€‚

æŸ¥é˜…èµ„æ–™ä¼šå‘ç°ï¼Œç¤¾åŒºå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéå¸¸æˆç†Ÿçš„æ–¹æ¡ˆï¼Œå³`eslint-config-prettier` + `eslint-plugin-prettier`ã€‚

- [eslint-plugin-prettier](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fprettier%2Feslint-plugin-prettier)ï¼š åŸºäº prettier ä»£ç é£æ ¼çš„ eslint è§„åˆ™ï¼Œå³eslintä½¿ç”¨pretterè§„åˆ™æ¥æ ¼å¼åŒ–ä»£ç ã€‚
- [eslint-config-prettier](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fprettier%2Feslint-config-prettier)ï¼š ç¦ç”¨æ‰€æœ‰ä¸æ ¼å¼ç›¸å…³çš„ eslint è§„åˆ™ï¼Œè§£å†³ prettier ä¸ eslint è§„åˆ™å†²çªï¼Œ**ç¡®ä¿å°†å…¶æ”¾åœ¨ extends é˜Ÿåˆ—æœ€åï¼Œè¿™æ ·å®ƒå°†è¦†ç›–å…¶ä»–é…ç½®**

### å®‰è£…ä¾èµ–

```shell
yarn add eslint-config-prettier eslint-plugin-prettier -D
```

### åœ¨ `.eslintrc.jsä¸­`extends`çš„æœ€åæ·»åŠ ä¸€ä¸ªé…ç½®

```js
{ 
    extends: [
    'eslint:recommended',
    'plugin:vue/vue3-essential',
    'plugin:@typescript-eslint/recommended',
+    // æ–°å¢ï¼Œå¿…é¡»æ”¾åœ¨æœ€åé¢
+    'plugin:prettier/recommended' 
  ],
}
```

æœ€å**é‡å¯vscode**ï¼Œä½ ä¼šå‘ç°å†²çªæ¶ˆå¤±äº†ï¼Œ`eslint`ä¸`prettier`ä¹ŸæŒ‰ç…§æˆ‘ä»¬é¢„æƒ³çš„å„å¸å…¶èŒäº†ã€‚

## gitæäº¤æ£€æµ‹

- husky(æ·»åŠ git hook)
- lint-staged

## é…ç½® husky + lint-staged

ç†è®ºä¸Šï¼Œåˆ°ä¸Šä¸€æ­¥æˆ‘ä»¬å·²ç»èƒ½ä½¿å¾—æˆ‘ä»¬çš„é¡¹ç›®è·å¾—ä¸é”™çš„å¼€å‘è§„èŒƒçº¦æŸäº†ã€‚ç„¶è€Œä»ç„¶æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š

- å¦‚æœæ˜¯åœ¨é¡¹ç›®ä¸­é€”æ‰æ¥å…¥`eslint + prettier`,å¦‚æœå¯¹åŸæ¥çš„ä»£ç ä½¿ç”¨`yarn run lint `æˆ–è€… `yarn run format`åŠ¿å¿…ä¼šå¸¦æ¥å¤§èŒƒå›´åœ°æ”¹åŠ¨ï¼Œç”šè‡³ä¼šé€ æˆå†²çªã€‚
- å¯¹äºä¸€äº›ä¸ä½¿ç”¨`vscode`ç¼–è¾‘å™¨ï¼Œæˆ–è€…æ²¡æœ‰å®‰è£…`prettier`å’Œ`eslint`æ’ä»¶çš„ç”¨æˆ·è€Œè¨€ï¼Œä»–ä»¬ä¸èƒ½äº«å—åˆ°æ’ä»¶å¸¦æ¥çš„ååŠ©ï¼Œè€Œä»–ä»¬çš„ä»£ç è‡ªç„¶å¤§æ¦‚ç‡æ˜¯ä¸ç¬¦åˆè§„èŒƒçš„ï¼Œä¸è¯¥è¢«æäº¤åˆ°ä»£ç åº“ã€‚

åŸºäºä¸Šè¿°çš„é¡¾è™‘ï¼Œç¤¾åŒºæä¾›äº† `husky + lint-staged`çš„æ¸è¿›å¼æ–¹æ¡ˆã€‚ `lint-staged` æ˜¯ä¸€ä¸ªåªæ£€æµ‹`git`æš‚å­˜åŒºçš„`lint`å·¥å…·ï¼Œ`husky`æ˜¯ä¸€ä¸ªç”¨æ¥ç»™æˆ‘ä»¬çš„é¡¹ç›®æ·»åŠ `git hook`çš„å·¥å…·ï¼Œ`git hook`æ˜¯è¿›è¡Œgitæ“ä½œä¼šè§¦å‘çš„è„šæœ¬ï¼Œä¾‹å¦‚ï¼šæäº¤çš„æ—¶å€™ä¼šè§¦å‘`pre-commit`é’©å­,è¾“å…¥æäº¤ä¿¡æ¯ä¼šè§¦å‘`commit-msg`é’©å­ã€‚ æˆ‘ä»¬ç”¨`husky`å®‰è£…`pre-commit`é’©å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿›è¡Œ`git commit`æ“ä½œçš„æ—¶å€™ï¼Œè¿è¡Œæˆ‘ä»¬çš„è„šæœ¬æ¥æ£€æµ‹å¾…æäº¤çš„ä»£ç æ˜¯å¦è§„èŒƒï¼Œä¾¿å¯ä»¥åªå¯¹æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ã€‚

é¦–å…ˆå®‰è£…ä¾èµ–

```shell
yarn add husky lint-staged -D
```

æ·»åŠ ä¸€ä¸ªåœ¨`package.json`ä¸­æ·»åŠ ä¸€æ¡`preinstall`è„šæœ¬

```json
{
    "script":{
        "prepare": "husky install"
    }
}
```

`prepare`è„šæœ¬ä¼šåœ¨ `yarn` ä¹‹åè‡ªåŠ¨è¿è¡Œï¼Œè¿™æ ·ä¾èµ–ä½ çš„å°ä¼™ä¼´`clone`äº†ä½ çš„é¡¹ç›®ä¹‹åä¼šè‡ªåŠ¨å®‰è£…`husky`,è¿™é‡Œç”±äºæˆ‘ä»¬å·²ç»è¿è¡Œè¿‡ `yarn` äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è¿è¡Œä¸€æ¬¡`yarn  prepare`,ç„¶åæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä¸€ä¸ªç›®å½•`.husky`ã€‚

<img src="./assets/image-20221002180204774.png" alt="image-20221002180204774" style="zoom:50%;" />

æ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºæˆ‘ä»¬gitä»“åº“æ·»åŠ ä¸€ä¸ª`pre-commit`é’©å­,è¿è¡Œ

```shell
npx husky add .husky/pre-commit "npx --no-install lint-staged"
```

è¿™å›åœ¨æˆ‘ä»¬çš„.huskyç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª`pre-commit`çš„è„šæœ¬

```shell
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# commitä¹‹å‰è§¦å‘
npx --no-install lint-staged
```

æ¥ä¸‹æ¥æˆ‘ä»¬é…ç½®`lint-staged`,åœ¨`package.json`ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®ä¿¡æ¯ã€‚

```json
"lint-staged": {
      "*.{js,vue,ts,jsx,tsx}": [
        "prettier --write",
        "eslint --fix"
      ],
      "*.{html,css,less,scss,md}": [
        "prettier --write"
      ]
 },
```

è¿™æ ·ä¹‹åï¼Œæˆ‘ä»¬åç»­æäº¤åˆ°æš‚å­˜åŒºçš„ä»£ç ä¹Ÿå°±ä¼šè¢«`eslint+prettier`æ ¼å¼åŒ–å’Œæ£€æŸ¥ï¼Œè¿›ä¸€æ­¥ä¿è¯æˆ‘ä»¬çš„ä»£ç è§„èŒƒã€‚

### æµ‹è¯•

```shell
git add .
git commit -m 'æµ‹è¯•eslintæŠ¥é”™æ˜¯å¦å¯ä»¥æäº¤'
```

å¯ä»¥å‘ç°æ— æ³•æäº¤(ä½¿ç”¨`git status` æŸ¥çœ‹çŠ¶æ€)

ä½¿ç”¨`yarn format`æ ¼å¼åŒ–åå°±å¯ä»¥æäº¤äº† 



## commitlintè§„èŒƒ

åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„ä»£ç æäº¤å¸¸å¸¸æ˜¯æ¯”è¾ƒæ½¦è‰çš„ï¼Œå¯èƒ½æœ‰æ—¶å€™åªä¼šå†™ä¸ªç®€å•çš„ä¿®å¤ï¼Œè¿™æ ·çš„æäº¤ä¿¡æ¯è™½ç„¶å¼€å‘ä¸­çœæ—¶çœåŠ›ï¼Œä½†åœ¨ä»£ç å›é¡¾ã€ç»´æŠ¤æ—¶ï¼Œå¸¸å¸¸éœ€è¦æäº¤ä¿¡æ¯æ‰èƒ½æ›´å¥½ç†è§£ä»£ç çš„ä½œç”¨ï¼Œå› æ­¤ä»£ç æäº¤ä¿¡æ¯çš„è§„èŒƒåŒ–å…¶å®æ˜¯å‰ç«¯ä»£ç è§„èŒƒä¸­çš„é‡è¦ä¸€ç¯ï¼Œè€Œ`commitlint`æ˜¯ä¸€ä¸ªå¸®æˆ‘ä»¬æ£€æŸ¥commit msgæ˜¯å¦ç¬¦åˆè§„èŒƒçš„å·¥å…·ã€‚ [commitlintä»“åº“åœ°å€ï¼šhttps://github.com/conventional-changelog/commitlint](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fconventional-changelog%2Fcommitlint)

#### å®‰è£…`commitlint`

```shell
yarn add @commitlint/{config-conventional,cli} -D
```

#### åˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆ`echo`åˆ›å»ºè®°å¾—å°†ç¼–ç æ”¹ä¸º`utf-8`ï¼‰

```shell
echo "module.exports = {extends: ['@commitlint/config-conventional']}" > commitlint.config.js
```

#### é…ç½®husky hook

åœ¨package.jsonçš„husky hooké…ç½®ä¸­æ·»åŠ  `"commit-msg": "commitlint -E HUSKY_GIT_PARAMS"`

```json
"husky": {
  "hooks": {
    "pre-commit": "lint-staged",
    "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
  }
},
```

#### åœ¨.huskyæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆ`commit-msg`hook

```shell
npx husky add .husky/commit-msg 'npx --no-install commitlint --edit $1'
```

#### æµ‹è¯•

å¦‚æœcommit msgä¸ºciä¸è§„èŒƒæ¶ˆæ¯åˆ™åœ¨commitæ—¶ä¼šæŠ¥é”™ï¼Œå¦‚æœä½¿ç”¨ci: add commitlint`å°†ä¼šæäº¤æˆåŠŸã€‚

<img src="./assets/image-20221002213052571.png" alt="image-20221002213052571" style="zoom:50%;" />

<img src="./assets/image-20221002213145063.png" alt="image-20221002213145063" style="zoom:50%;" />


#### commitlintè§„èŒƒ

[commitlintè§„èŒƒæ–‡æ¡£åœ°å€](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fconventional-changelog%2Fcommitlint%2Ftree%2Fmaster%2F%40commitlint%2Fconfig-conventional)

```shell
git commit -m 'fix: ä¿®å¤xxxçš„bug'

git commit -m 'ci: æ­å»ºåŸºç¡€é…ç½®'
```



<br/>
<hr />

â­ï¸â­ï¸â­ï¸å¥½å•¦ï¼ï¼ï¼æœ¬æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸå•¦ã€‚â­ï¸â­ï¸â­ï¸

âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿

æ’’èŠ± ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸
