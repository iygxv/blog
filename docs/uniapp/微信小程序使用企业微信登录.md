---
sidebar: 
 title: å¾®ä¿¡å°ç¨‹åºä½¿ç”¨ä¼ä¸šå¾®ä¿¡ç™»å½•
 step: 1
 isTimeLine: true
title: å¾®ä¿¡å°ç¨‹åºä½¿ç”¨ä¼ä¸šå¾®ä¿¡ç™»å½•
tags:
 - Uniapp
categories:
 - Uniapp
---

# å¾®ä¿¡å°ç¨‹åºä½¿ç”¨ä¼ä¸šå¾®ä¿¡ç™»å½•
åœ¨å¾®ä¿¡å°ç¨‹åºä¸­å®ç°ç”¨æˆ·ç‚¹å‡»ç™»å½•è·³è½¬åˆ°ä¼ä¸šå¾®ä¿¡æˆæƒç™»å½•é¡µé¢çš„åŠŸèƒ½ï¼Œéœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š
- æ„é€ ç½‘é¡µæˆæƒé“¾æ¥
- åœ¨å°ç¨‹åºä¸­å‘èµ·è·³è½¬
- ç”¨æˆ·æˆæƒå¹¶å›è°ƒå¤„ç†

æˆ‘ä»¬ä»è¿™ä¸‰æ–¹é¢æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚

## æ„é€ ç½‘é¡µæˆæƒé“¾æ¥

å¦‚æœä¼ä¸šéœ€è¦åœ¨æ‰“å¼€çš„ç½‘é¡µé‡Œé¢æºå¸¦ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼Œç¬¬ä¸€æ­¥éœ€è¦æ„é€ å¦‚ä¸‹çš„é“¾æ¥æ¥è·å–codeå‚æ•°ï¼š
```text
https://open.weixin.qq.com/connect/oauth2/authorize?appid=CORPID&redirect_uri=REDIRECT_URI&response_type=code&scope=snsapi_base&state=STATE&agentid=AGENTID#wechat_redirect
```
å‚æ•°è¯´æ˜å¯ä»¥åœ¨[å®˜æ–¹é“¾æ¥](https://developer.work.weixin.qq.com/document/path/91022)ä¸­æŸ¥çœ‹

è¿™é‡Œä¸»è¦è¯´ä¸€ä¸‹ 2 ä¸ªå‚æ•°
- appid
- redirect_uri

**appid** éœ€è¦åœ¨ä¼ä¸šå¾®ä¿¡->æˆ‘çš„ä¼ä¸šä¸­è·å–: https://work.weixin.qq.com/wework_admin/frame#profile

<img src="./assets/qy-appid.png" alt="" />

**redirect_uri** åˆ™éœ€è¦åœ¨ä¼ä¸šå¾®ä¿¡->åº”ç”¨ä¸­ä¸­è·å–ï¼Œç‚¹è¿›å»è‡ªå»ºçš„åº”ç”¨ï¼Œè¿›å…¥ç½‘é¡µæˆæƒé¡µé¢ï¼Œç‚¹å‡»æ·»åŠ ç½‘é¡µæˆæƒåŸŸåï¼Œæ·»åŠ åŸŸåï¼Œç„¶åç‚¹å‡»ä¿å­˜ã€‚

è‡ªå»ºçš„åº”ç”¨çš„åœ°å€æ˜¯ï¼šhttps://work.weixin.qq.com/wework_admin/frame#apps

<img src="./assets/qy-redirect-url.png" alt="" />

<img src="./assets/qy-redirect-url2.png" alt="" />

è¿™é‡Œé…ç½®å¯ä¿¡åŸŸåéœ€å®ŒæˆåŸŸåå½’å±è®¤è¯éœ€è¦åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šæ·»åŠ ä¸€ä¸ª `txt` æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶æ”¾åœ¨ä¸ `index.html` æ–‡ä»¶åŒä¸€ä¸ªç›®å½•

å¦å¤–è¿˜è¦é…ç½®æœåŠ¡å™¨ip ï¼Œå› ä¸ºä¼ä¸šå¾®ä¿¡è¯´äº†ï¼šä¼ä¸šå¯ä¿¡IPä¸ºæœ¬ä¼ä¸šæœåŠ¡å™¨çš„IPåœ°å€ï¼Œä»…æ‰€é…IPå¯é€šè¿‡æ¥å£è·å–ä¼ä¸šæ•°æ®ã€‚

<img src="./assets/qy-redirect-url3.png" alt="" />

## åœ¨å°ç¨‹åºä¸­å‘èµ·è·³è½¬
åœ¨å°ç¨‹åºä¸­å‘èµ·è·³è½¬ä¸­éœ€è¦ä¸€ä¸ª webview é¡µé¢ ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸“é—¨åˆ›å»ºä¸€ä¸ªåªå¤„ç†è¿™ä¸ªç™»å½•çš„ webview é¡µé¢ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š

```vue
<template>
  <web-view :src="enterpriseWeChatAuthUrl"></web-view>
</template>

<script>
export default {
  data() {
    return {
      enterpriseWeChatAuthUrl: `https://open.weixin.qq.com/connect/oauth2/authorize?appid=ä¼ä¸šID&redirect_uri=redirect_uri&response_type=code&scope=snsapi_privateinfo&state=STATE&agentid=1000003#wechat_redirect`
    }
  },
  onload() {
  }
}
</script>
```
**æ³¨æ„**
scope è®¾ç½®äº†è¿™ä¸ª snsapi_privateinfoï¼Œ éœ€è¦æ‰«ç ä¼ä¸šå¾®ä¿¡->æˆ‘çš„ä¼ä¸š->å¾®ä¿¡æ’ä»¶ ä¸­é‚€è¯·å…³æ³¨çš„äºŒç»´ç 

## ç”¨æˆ·æˆæƒå¹¶å›è°ƒå¤„ç†
ç”¨æˆ·æˆæƒåä¼šè¿”å›ä¸€ä¸ª urlï¼Œä¾‹å¦‚ï¼š https://xxx?code=6NUxlmKDikOqQDPqTQ5vlH-XlMJA-ey3mFGd1MHYorM&amp;state=STATE 

è¿™é‡Œä¼šå¸¦å›ä¸€ä¸ª codeï¼Œæ ¹æ® code + åç«¯çš„æ¥å£æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°ç”¨æˆ·çš„ä¿¡æ¯

è¿™é‡Œçš„è¯æˆ‘ä¸»è¦æƒ³è®²çš„æ˜¯ï¼š `h5 å¦‚ä½•è·³è½¬åˆ°å°ç¨‹åºä¸­`ï¼Œ å› ä¸ºè¿™ä¸ª url è·³è½¬çš„è¿˜æ˜¯å°ç¨‹åºçš„ web-view é¡µé¢ï¼Œ å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ h5 é¡µé¢ä¸­ä½¿ç”¨ `wx.miniProgram` å¯¹è±¡æ–¹æ³•è¿›è¡Œè·³è½¬

**ç›¸å…³æ­¥éª¤**

- é¦–é¡µéœ€è¦åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°ä¸‹é…ç½®ä¸šåŠ¡åŸŸåï¼ˆä¹Ÿå°±æ˜¯ä½ çš„h5åœ°å€ï¼‰
  [å»é…ç½®](https://mp.weixin.qq.com)ï¼Œ å…·ä½“çš„è·¯å¾„æ˜¯å¼€å‘ç®¡ç†->ä¸šåŠ¡åŸŸå

- é…ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ˜¯ç”¨ `wx-sdk` çš„æ–¹æ³•äº†
  å…ˆè¦åœ¨ index.htmlä¸­å¼•å…¥ wx-sdk

  ```js
  <script src="//res2.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
  ```
  ç„¶å `wx.miniProgram.redirectTo` è¿›è¡Œè·³è½¬

  ```vue
  <template>
    <div></div>
  </template>

  <script>
  import wx from 'wx'
  export default {
    data() {
      return {
      }
    },
    created() {
     const { code } = this.$route.query
      wx.miniProgram.redirectTo({
        url: `/pages/login/login?code=${code}`
      })
    }
  }
  </script>

  ```


<br/>
<hr />

â­ï¸â­ï¸â­ï¸å¥½å•¦ï¼ï¼ï¼æœ¬æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸå•¦ã€‚â­ï¸â­ï¸â­ï¸

âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿

æ’’èŠ± ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸
