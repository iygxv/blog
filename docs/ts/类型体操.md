---
sidebar:
  title: TypeScript ç±»å‹ä½“æ“
  step: 1
  isTimeLine: true
title: TypeScript ç±»å‹ä½“æ“
tags:
  - TypeScript
categories:
  - TypeScript
---

# TypeScript ç±»å‹ä½“æ“

## **ç±»å‹ä½“æ“æ˜¯ä»€ä¹ˆ**

TypeScript ç»™ JavaScript å¢åŠ äº†ä¸€å¥—é™æ€ç±»å‹ç³»ç»Ÿï¼Œé€šè¿‡ TS Compiler ç¼–è¯‘ä¸º JSï¼Œç¼–è¯‘çš„è¿‡ç¨‹åšç±»å‹æ£€æŸ¥

TS çš„é™æ€ç±»å‹æœ‰äº›æ­»æ¿,å› æ­¤æ–°å¢äº†åŠ¨æ€ç±»å‹,ä¹Ÿå°±æ˜¯åŠ¨æ€ç¼–ç¨‹(`è¿™ä¹Ÿå«åšç±»å‹ä½“æ“`)

`å¯¹ä¼ å…¥çš„ç±»å‹å‚æ•°ï¼ˆæ³›å‹ï¼‰åšå„ç§é€»è¾‘è¿ç®—ï¼Œäº§ç”Ÿæ–°çš„ç±»å‹ï¼Œè¿™å°±æ˜¯ç±»å‹ç¼–ç¨‹` ç±»å‹ç¼–ç¨‹ä¹Ÿå°±æ˜¯ç±»å‹ä½“æ“

## **TypeScript ç±»å‹ç³»ç»Ÿä¸­çš„ç±»å‹è¿ç®—**

### **æ¡ä»¶ï¼šextends ? :**

TypeScript é‡Œçš„æ¡ä»¶åˆ¤æ–­æ˜¯ `extends ? :`ï¼Œå«åšæ¡ä»¶ç±»å‹ï¼ˆConditional Typeï¼‰æ¯”å¦‚ï¼š

```ts
type res = 1 extends 2 ? true : false;
```

![image-20221018153036405](./assets/image-20221018153036405.png)

### **æ¨å¯¼ï¼šinfer**

å¦‚ä½•æå–ç±»å‹çš„ä¸€éƒ¨åˆ†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ inferã€‚

æ¯”å¦‚æå–å…ƒç»„ç±»å‹çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š

```ts
type First<Tuple extends unknown[]> = Tuple extends [infer T, ...infer R]
  ? T
  : never;

type FirstRes = First<[1, 2, 3]>;
```

![image-20221018153407009](./assets/image-20221018153407009.png)

### **è”åˆï¼šï½œ**

è”åˆç±»å‹ï¼ˆUnionï¼‰ç±»ä¼¼ js é‡Œçš„æˆ–è¿ç®—ç¬¦ |ï¼Œä½†æ˜¯ä½œç”¨äºç±»å‹ï¼Œä»£è¡¨ç±»å‹å¯ä»¥æ˜¯å‡ ä¸ªç±»å‹ä¹‹ä¸€ã€‚

```ts
type Union = 1 | 2 | 3;
```

### **äº¤å‰ï¼š&**

äº¤å‰ç±»å‹ï¼ˆIntersectionï¼‰ç±»ä¼¼ js ä¸­çš„ä¸è¿ç®—ç¬¦ &ï¼Œä½†æ˜¯ä½œç”¨äºç±»å‹ï¼Œä»£è¡¨å¯¹ç±»å‹åšåˆå¹¶ã€‚

```ts
type ObjType = { a: number } & { c: boolean };
```

![image-20221018153805453](./assets/image-20221018153805453.png)

æ³¨æ„ï¼ŒåŒä¸€ç±»å‹å¯ä»¥åˆå¹¶ï¼Œä¸åŒçš„ç±»å‹æ²¡æ³•åˆå¹¶ï¼Œä¼šè¢«èˆå¼ƒï¼š

![image-20221018153909367](./assets/image-20221018153909367.png)

### **æ˜ å°„ç±»å‹**

å¯¹è±¡ã€class åœ¨ TypeScript å¯¹åº”çš„ç±»å‹æ˜¯ç´¢å¼•ç±»å‹ï¼ˆIndex Typeï¼‰ï¼Œé‚£ä¹ˆå¦‚ä½•å¯¹ç´¢å¼•ç±»å‹ä½œä¿®æ”¹å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯`æ˜ å°„ç±»å‹`ã€‚

```ts
type MapType<T> = {
  [Key in keyof T]?: T[Key];
};
```

keyof T æ˜¯æŸ¥è¯¢ç´¢å¼•ç±»å‹ä¸­æ‰€æœ‰çš„ç´¢å¼•ï¼Œå«åš`ç´¢å¼•æŸ¥è¯¢`ã€‚

T[Key] æ˜¯å–ç´¢å¼•ç±»å‹æŸä¸ªç´¢å¼•çš„å€¼ï¼Œå«åš`ç´¢å¼•è®¿é—®`ã€‚

in æ˜¯ç”¨äºéå†è”åˆç±»å‹çš„è¿ç®—ç¬¦ã€‚

æ¯”å¦‚æˆ‘ä»¬æŠŠä¸€ä¸ªç´¢å¼•ç±»å‹çš„å€¼å˜æˆ 3 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼š

```ts
type MapType<T> = {
  [Key in keyof T]: [T[Key], T[Key], T[Key]];
};

type res = MapType<{ a: 1; b: 2 }>;
```

![image-20221018154225087](./assets/image-20221018154225087.png)

## **ç±»å‹ä½“æ“é¡ºå£æºœ**

**æ¨¡å¼åŒ¹é…åšæå–ï¼Œé‡æ–°æ„é€ åšå˜æ¢ã€‚**

**é€’å½’å¤ç”¨åšå¾ªç¯ï¼Œæ•°ç»„é•¿åº¦åšè®¡æ•°ã€‚**

**è”åˆåˆ†æ•£å¯ç®€åŒ–ï¼Œç‰¹æ®Šç‰¹æ€§è¦è®°æ¸…ã€‚**

**åŸºç¡€æ‰å®å¥—è·¯ç†Ÿï¼Œç±»å‹ä½“æ“å¯é€šå…³ã€‚**

## **æ¨¡å¼åŒ¹é…åšæå–**

å°±åƒå­—ç¬¦ä¸²å¯ä»¥é€šè¿‡æ­£åˆ™æå–å­ä¸²ä¸€æ ·ï¼ŒTypeScript çš„ç±»å‹ä¹Ÿå¯ä»¥é€šè¿‡åŒ¹é…ä¸€ä¸ªæ¨¡å¼ç±»å‹æ¥æå–éƒ¨åˆ†ç±»å‹åˆ° infer å£°æ˜çš„å±€éƒ¨å˜é‡ä¸­è¿”å›ã€‚

æ¯”å¦‚æå–å‡½æ•°ç±»å‹çš„è¿”å›å€¼ç±»å‹ï¼š

```ts
type GetReturnType<Func extends Function> = Func extends (
  ...args: any[]
) => infer ReturnType
  ? ReturnType
  : never;
```

![image-20221014114904329](./assets/image-20221014114904329.png)

### **ä¾‹å­**

```ts
// å¥—è·¯ä¸€: æ¨¡å¼åŒ¹é…åšæå–
// æå– value çš„ç±»å‹
type GetValue<P> = P extends Promise<infer value> ? value : never;
type GetValueRes = GetValue<Promise<"vvv">>;

// åˆ é™¤æ•°ç»„ç¬¬ä¸€ä¸ª
type ShiftArr<T extends unknown[]> = T extends []
  ? []
  : T extends [infer Fistr, ...infer Rest]
  ? Rest
  : never;
type ShiftArrRes = ShiftArr<[1, 2, 3]>;

// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŸä¸ªå‰ç¼€å¼€å¤´
type StartsWith<
  Str extends string,
  perfix extends string
> = Str extends `${perfix}${string}` ? true : false;
type StartsWithType = StartsWith<"vvvcode", "vvv">;

// å­—ç¬¦ä¸²æ›¿æ¢
type ReplaceStr<
  Str extends string,
  From extends string,
  To extends string
> = Str extends `${infer perfix}${From}${infer suffix}`
  ? `${perfix}${To}${suffix}`
  : Str;

// ?æ›¿æ¢å˜»å˜»å˜»å˜»
type ReplaceStrRes = ReplaceStr<"vvv is boy hha ?", "?", "å˜»å˜»å˜»å˜»">;

// å»æ‰å­—ç¬¦ä¸²çš„ç©ºç™½ç¬¦(å› ä¸ºç©ºç™½ç¬¦å¾ˆå¤š, éœ€è¦é€’å½’)
type Trim<Str extends string> = Str extends `${infer Rest}${" "}`
  ? Trim<Rest>
  : Str;
type TrimRes = Trim<"vvvv                 ">;

// æå–å‡½æ•°å‚æ•°ç±»å‹
type GetParametersType<Func extends Function> = Func extends (
  ...args: infer Args
) => unknown
  ? Args
  : never;
type GetParametersTypeRes = GetParametersType<(a: number, b: string) => string>;

// æå–å‡½æ•°è¿”å›ç±»å‹
type GetFnReturnType<Func extends Function> = Func extends (
  ...args: any[]
) => infer ReturnType
  ? ReturnType
  : never;
type GetFnReturnTypeRes = GetFnReturnType<(a: number, b: string) => string>;

// æå–thisç±»å‹
class Vvv {
  name: string;

  constructor() {
    this.name = "dong";
  }

  hello(this: Vvv) {
    return "hello, I'm " + this.name;
  }
}
const vvv = new Vvv();
vvv.hello();

// vvv.hello.call({xxx:1});
type GetThisType<T> = T extends (this: infer ThisType, ...args: any[]) => any
  ? ThisType
  : unknown;
type GetThisTypeRes = GetThisType<typeof vvv.hello>;

// æ„é€ å™¨
interface Person {
  name: string;
}

interface PersonConstructor {
  new (name: string): Person;
}
// æå–æ„é€ å™¨(å®ä¾‹å¯¹è±¡)
type GetConstructorInstance<Constructor extends new (...args: any) => any> =
  Constructor extends new (...args: any) => infer Instance ? Instance : any;
type GetConstructorInstanceRes = GetConstructorInstance<PersonConstructor>;

// æå–æ„é€ å™¨å‚æ•°ç±»å‹
type GetConstructorParamsters<Constructor extends new (...args: any) => any> =
  Constructor extends new (...args: infer Paramsters) => any ? Paramsters : any;
type GetConstructorParamstersRes = GetConstructorParamsters<PersonConstructor>;

// æå–refå€¼ç±»å‹
type GetRefProps<Props> = "ref" extends keyof Props
  ? Props extends { ref?: infer Value | undefined }
    ? Value
    : never
  : never;
type GetRefPropsRes = GetRefProps<{ ref: 1 }>;
type GetRefPropsRes2 = GetRefProps<{ a: 1 }>;
```

[æ¨¡å¼åŒ¹é…åšæå–](https://www.typescriptlang.org/play?#code/FAehAJHVNR72MADkC5yEIrQ8PqE5lQsomC0FQC8aDXlUCfcANwEMAbAVwFNxAQt0G8fQaPVgAXATwAc6BxGtgDVKtADwAFAHzgAvOHDjwNAB5saAOwAmAZwUAnAPYBbAJbaaok+oBmNPaRE1pAfgfU6idTRJ323PgLC7gBKNLpy-EKOEoam5qIA5CTJCZKSwITggARKgCZpgA6mgCN+gDTesIBUcn484ADKABYm1mwAgnp6ogAqSqoaOuBU6gDW6gYA7uoA2gC60nIdKmpaupPgrkuIs10L4GNWtvYAYmZsegA04AB0Fzt24KHabBPLN2Fs4J7evpyVtfVNLbey1TqDWarTGAEZTgAmU4AZimGTA4EAJEqAWtNAOragDJvQBMcoB6M0AZCqAU7lAAvmpUAskqAAH9AAD6gBZNCp0KpsMh6NjaADqJjYNVEDPsc26ujueisAHNTjw9NYTMpOvMeoKRdNqkcZfzwAADAAkAG9xZLlABfbXy9TC-Vqx5HWivcDWSjmOlKpks9mctr+AEMp1sjlcpLJADGBk0NASpz9JFSCIgmKxgH+zQBGxg7QlwKGR-TQedzlXzNsbReA9rEVbmjiLTm0DMW5aWTYrgDyq7pNVqrvZdVLDVrC8ZO63wNoqNY9WbHs32wbtRXOwOhx3zYgeVHlgnANxqa5XSZoKbTGaO-zkydT6cz4fAZnAACMDBxwDUamRlqHwAlnE+EuuV5HMoBu5UAkcYx+hAC8vQBfNwxAAKQADtUALjkQIxQAI-UALE1TkAAHTAEDIwAkBMAJX0AEoHTaIUjCzXkNmrIVaw9bMSKbbU+1uNhOwSZ8R1cfCTEIujJAXI48II-dwFYwjwxIeQRNEsSRK-RF8EAX8U8kAIeU8hYB1InEJkyCMAQ7G0N0eFEPY+n9RsCwMtgTAMdRFX09RDJzHowIuM4mWFbRED7ZpnOw2RpD6QYRnUR53N0N4fD0ZSBFUvR1M0vRtP8PiVLUjS1BinSLDAshPCoIwL2uY4L0QPNPJkaQ83STIZLyQAV+MAPbUlM+AI2D2dRQjYKg9HUVK9IMoyrP9UzzMs7rbN0eyLiclzwDIdQOEmIrpFogQ2o691XBapbUutLwQrCxrmsW9rUvigQmrWg7-FEdLMuy3L8v7GthTmu6yOFMqpLwTkzCU-1U20XRBGScAtWAUT1Cigr7oAbgyUTA3UQUqD6gw9DAzygfE+QPu0M5QY0gEACJNHM4U8ah0T9WhkSahoCgKAMMDMcQf6SFR4H0b0fb-ISKmaYMU4AEkAB0EiMZ9wAAanATHsai0mRPJ8nYbuUgAbkLxhnAJmUah5ISDObnaa1pcdb16nabOf1KAoMCtWUW34DBfVsKh+rwEiNo6li3S2kVdZZRGhmzxsa53bMVLTgc8bECmmaJke6PHhDz2PF6AYhlGHbE8OsIATdj3OvqgxrGV3X9YMV6IEAEPNAAIEwALNWAKxkttdMFC08zAdZ+QcZocHnqh8n6-URudxbmLzIAYXM+HEfsNGRLVsCu57kVsMQcRW-UPvyrwaua7AwA87UAaPlAE-tQBDGNwl3IgnuHLWnvnr6m9NRCvqe2CRoy1fAUbHL0Zyo+muPpp1mfjfV+xE-bgA-l-SOk1-5eUDrscAd87gPzoK4JBjJrLJ2jjtYBegEagPQSgo6bBcH4KRoQzBEh16kOnuXcA+Ad4KTqu6S+k8QFIwiupO4Wkn5sLwdPd+NB1ZQJ-hNaOACOBAL4WQsBqpIER1Ea5IO9hOFGG4TFCRjxVHqKCjAjgODpHT20clbQxCaGgOMTwteo91DmKRnQ-A7NrCAB4FZhlRIihGsOIQwXBtAxAML4xUCQnGMWGuAfoNAOCF30AE3QrgO5iW8bEoyWpwBOOcEohBQQrQAB8U7BklF4TQ+pHjZOTlta4CTRLBQ+CwgQnikm+OIQ0nxfitROMQA7dIF96k0C8a024kIc69P6bE0QWoMrgC6UAA)

## **é‡æ–°æ„é€ åšå˜æ¢**

TypeScript ç±»å‹ç³»ç»Ÿå¯ä»¥é€šè¿‡ type å£°æ˜ç±»å‹å˜é‡ï¼Œé€šè¿‡ infer å£°æ˜å±€éƒ¨å˜é‡ï¼Œç±»å‹å‚æ•°åœ¨ç±»å‹ç¼–ç¨‹ä¸­ä¹Ÿç›¸å½“äºå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å®ƒä»¬éƒ½ä¸èƒ½åšä¿®æ”¹ï¼Œæƒ³è¦å¯¹ç±»å‹åšå˜æ¢åªèƒ½æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œåœ¨æ„é€ çš„è¿‡ç¨‹ä¸­åšè¿‡æ»¤å’Œè½¬æ¢ã€‚

åœ¨å­—ç¬¦ä¸²ã€æ•°ç»„ã€å‡½æ•°ã€ç´¢å¼•ç­‰ç±»å‹éƒ½æœ‰å¾ˆå¤šåº”ç”¨ï¼Œç‰¹åˆ«æ˜¯ç´¢å¼•ç±»å‹ã€‚

æ¯”å¦‚æŠŠç´¢å¼•å˜ä¸ºå¤§å†™ï¼š

```ts
type UppercaseKey<Obj extends Record<string, any>> = {
  [Key in keyof Obj as Uppercase<Key & string>]: Obj[Key];
};
```

![image-20221014115114882](./assets/image-20221014115114882.png)

```ts
// é‡æ–°æ„é€ å«å˜æ¢

// æ•°ç»„ç±»å‹çš„é‡æ–°æ„é€ 
// Push

type Push<Arr extends unknown[], Ele> = [...Arr, Ele];
type PushRes = Push<[1, 2, 3], "123">;

// Zip(å…ƒç»„åˆå¹¶)
type Zip<
  One extends [unknown, unknown],
  Other extends [unknown, unknown]
> = One extends [infer OneFirst, infer OneSecond]
  ? Other extends [infer OtherFirst, infer OtherSecond]
    ? [[OneFirst, OtherSecond], [OneSecond, OtherFirst]]
    : []
  : [];

type tuple1 = [1, 2];
type tuple2 = ["vvv", "code"];
type ZipRes = Zip<tuple1, tuple2>;

// å¦‚æœæ˜¯ä»»æ„ä¸ªå‘¢ï¼Ÿ
type Zip2<One extends unknown[], Other extends unknown[]> = One extends [
  infer OneFirst,
  ...infer OneRest
]
  ? Other extends [infer OtherFirst, ...infer OtherRest]
    ? [[OneFirst, OtherFirst], ...Zip2<OneRest, OtherRest>]
    : []
  : [];

type tuple3 = [1, 2, 3, 4, 5];
type tuple4 = ["code1", "code2", "code3", "code4", "code5"];
type ZipRes2 = Zip2<tuple3, tuple4>;

// å­—ç¬¦ä¸²ç±»å‹çš„é‡æ–°æ„é€ 
// CapitalizeStr -- æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ç±»å‹çš„ 'vvv' è½¬ä¸ºé¦–å­—æ¯å¤§å†™çš„ 'Vvv'ã€‚
type CapitalizeStr<Str extends string> =
  Str extends `${infer First}${infer Rest}`
    ? `${Uppercase<First>}${Rest}`
    : Str;
type CapitalizeStrRes = CapitalizeStr<"vvv">;

// CamelCase -- å®ç°vvv_vvv_vvv åˆ° vvvVvvVvv çš„å˜æ¢
type CamelCase<Str extends string> =
  Str extends `${infer Left}_${infer Right}${infer Rest}`
    ? `${Left}${Uppercase<Right>}${CamelCase<Rest>}`
    : Str;
type CamelCaseRes = CamelCase<"vvv_vvv_vvv">;

// DropSubStr åˆ é™¤æŒ‡å®šå­—ç¬¦ä¸²   vvv___ åˆ é™¤_ => vvv

type DropSubStr<
  Str extends string,
  SubStr extends string
> = Str extends `${infer Perfix}${SubStr}${infer Suffix}`
  ? DropSubStr<`${Perfix}${Suffix}`, SubStr>
  : Str;

type DropSubStrRes = DropSubStr<"vvv___", "_">;

// å‡½æ•°ç±»å‹çš„é‡æ–°æ„é€ ï¼š
// AppendArgument æ·»åŠ å¤šä¸€ä¸ªå‚æ•°
type AppendArgument<Fun extends Function, Arg> = Fun extends (
  ...args: infer Args
) => infer ReturnType
  ? (...args: [...Args, Arg]) => ReturnType
  : never;

type AppendArgumentRes = AppendArgument<
  (a: number, b: string) => string,
  number
>;

// ç´¢å¼•ç±»å‹çš„é‡æ–°æ„é€ 
type Mapping<Obj extends object> = {
  [Key in keyof Obj]: Obj[Key];
};
type MappingRes = Mapping<{ a: 1; b: 2; c: 3 }>;

// UppercaseKey
type UppercaseKey<Obj extends object> = {
  // å› ä¸ºç´¢å¼•å¯èƒ½ä¸º stringã€numberã€symbol ç±»å‹, è¿™é‡Œåªèƒ½æ¥å— string ç±»å‹ï¼Œæ‰€ä»¥è¦ & stringï¼Œä¹Ÿå°±æ˜¯å–ç´¢å¼•ä¸­ string çš„éƒ¨åˆ†ã€‚
  [Key in keyof Obj as Uppercase<Key & string>]: Obj[Key];
};
type UppercaseKeyRes = UppercaseKey<{ a: 1; b: 2; c: 3 }>;

// çº¦æŸobjet --- Record
type RecordRes = Record<"test", 3>;
type UppercaseKey2<Obj extends Record<string, any>> = {
  [Key in keyof Obj as Uppercase<Key & string>]: Obj[Key];
};
type Uppercase2KeyRes = UppercaseKey<{ a: 1; b: 2; c: 3 }>;

// ToReadonly æ·»åŠ  readonly çš„ä¿®é¥°ç¬¦
type ToReadonly<T> = {
  readonly [Key in keyof T]: T[Key];
};
type ToReadonlyRes = ToReadonly<{ name: "vvv"; age: 18 }>;

// ToPartial æ·»åŠ å¯é€‰ä¿®é¥°ç¬¦
type ToPartial<T> = {
  [Key in keyof T]?: T[Key];
};
type ToPartialRes = ToPartial<{ name: "vvv"; age: 18 }>;

// ToMutable ç§»é™¤readonlyä¿®å¤å¸ˆ
type ToMutable<T> = {
  -readonly [Key in keyof T]: T[Key];
};

type ToMutableRes = ToMutable<{ readonly name: "vvv"; readonly age: 18 }>;

// ToRequired å»æ‰?å¯é€‰ä¿®é¥°ç¬¦
type ToRequired<T> = {
  [Key in keyof T]-?: T[Key];
};
type ToRequiredRes = ToRequired<{ name?: "vvv"; age?: 18 }>;

// FilterByValueType  åœ¨æ„é€ æ–°ç´¢å¼•ç±»å‹çš„æ—¶å€™æ ¹æ®å€¼çš„ç±»å‹åšä¸‹è¿‡æ»¤ï¼š

type FilterByValueType<Obj extends Record<string, any>, ValueType> = {
  [Key in keyof Obj as Obj[Key] extends ValueType ? Key : never]: Obj[Key];
};

interface Person {
  name: string;
  age: number;
  hobby: string[];
}
type FilterByValueTypeRes = FilterByValueType<Person, number>;
```

[é‡æ–°æ„é€ å«å˜æ¢](https://www.typescriptlang.org/play?#code/FAehAJFnEwG00EPNAIEw18qA3lQRsbFBQDqaBG-Q3j6DR6oCFuMCm4ACgK4DOAFhgC4CeADgKaW10A8AggCcB4dgA9G7AHYATGuCqSA1pID2Ad0kBtALoAacAFEANuwB84ALzhNAOjuCB+4+23AWHLvQBK7OVer0PJoAjPoATPoAzHrgAOTBYZGxphhg4ABaAJasABSAwoo4gBAqgG56AJRubJxZrDwA8pKcYhIycpoKyuqS+u2qGjG1jHTswk1SstY9nd1KvZLa5hbA4Mvg9Y3iY62ZkgBmw6sNAGKZAjSM+tt7wmsAyuwAxioy2uAA-OBLKwNDIxst1pd9t9hsdTudwIDroNhndHs83tZNGtQWd9MCBLCntIYkiGpiZGjoQIUYxtC8AFzWVwrZaUnRMSrgRhUVgmYKWayhcBhbQAbgqHmZrPYYQ5mliADcpbF9LFHtJ2LE+QKqtkfH4MtkeEK2fodSKUuRAEGagBzzQD0ZoBvuUA8IaAKjlAEYqgHx-lWa1hhOoNER-caTDQ6Qk-T3Nb0zTo6BafZZrQObAG7IFHE6o8B2GyQg7sdWkhER1ZE6P-TRp9Ek-QpotEzMvd6aXHsEu5n4kmIp6putaZ-3DTOmClUnPgOmuZ36yJirkRcCRfQAFn0AFZle5OPrp2K5SoFcEZXF5SLt+uFUlZbvp-vd3Olfyly71aKrK3tSyTFOmU-2NPDeRAOragDJvQBMcoQJBwPA5AAMIAIasJkjDgUYmQAF7sDcjDCAAtKh4CAFFGgAAcjav5-l+gBG6YA84mAXEUoSrE4CADbxgBccoAaZlfoAs9aAOSagCZikQcQAGrSoAQAzOhBUEwXBiHIQIPBifm4xnAI2wAOYLOAkmjP8AAGAAkADeaYkgAvlpaaZrpqkIhpmkAKqsBwAj3OBNDsDwJKmPpmlGaplJiQJkHQbBCFISh6ocoJPkif54mStKhppBBAC27BGBB9ngOh4CAHnagANzhRAD62UUeAgAMSuAFE8RKJXgEQaBeXFCV2Q5ylenIMnyYp9VBnIZlpgAMuwOyMLpWUGXGwheJkcl0H1g1XOAbnvMAZndb1LmWdZtn2TwI1jYwzlabF8WJQ53bGQOSkoVVe21YFVi7TVa0RRKOVSg9lFRRAAAiAgqKwNxUAARpJgAESoAJmmAODGgBZ2vhKzZVlWXgEDMMWOYFEMh472fd9f0oRJKFSY1KHyfo6OtTGTWSApHJE2pk37BQww7JkoguYTKEuWm307HTDMma8wCo19v1iTwZk0wIHOM1Q7P08ZBP89j5geadzq80zAiXeASsy+FUNZfu2ufmkgC-ilggGkPAgBY-+QfBWWMghyVQcWSIw4CAN+2gAFSoAWJq4YAQ8pYM6lscDINt21IjCOQoOPgIcCj3IwmRPPoNuKZHkjhzkKbgQIck0JSaY2zQpTLAjEJDdN7DMgIkgACqMrNqd2Onmd0imufxxn2j54XPhl5XjKUg0ErDMjnB+9bGdBw7qvDwHo-2yHOTgb3ds-cM+g-ZSJNye35jr-okiL8ML3gIARL6AKj6xvAc6ACykFQaTdQ-QAVuHKgPw8W0cppOaaAA0uwzBF+Aihf4qB2KsB+2hKS1Aft-X+rhdKX2vvJVWV8rLyR4Jpee4AuSr25Poe4lJIi6QPstYYq12A-2YM6YhNlarkLvo-FS4xn731fopD+NI0iAAO1WiJ9AD3yoAX4DaLgHXoAQAZd4xSXgIYRNBmDiJUEYcAhB9CAE34wAM4mACvlPhgBS40AOvKQi8akwUQQQAMP+AAEjQAp3KAEDI8AAAyPRslSZGMAPpygBGHTNIANeUT6AFo5Ox8lyqAAuEwAYEr8RpNAv+2wAFAJAZAx+dlwBUNITwchNifGkx7JSUB99QmwMoVbah9lyGq3iTQ3+aCMFYMpBOPBk5CGpAgIAMr9AD65kw0uyUUo+EeAIaQzp2kqE6arHpnSeCxAkGcbckQUjXiKfk3+bYH7hwGdIHg29wDgUkMwUwrDP5JPCYA5gwCMkrLkFMhySTbHrzSZGKB5DsmTNyaQsIBTfAcmObQ9BlJyk4PAFUghB8K4qB8OBaQTwjB-1duAAQ7BAXAr-kQQAd-KAAdMn8Hxrx-IBUCyQIKeAV02TSCFUKMV-1Cf-XZ+yK7gPABXLJwA4Eov+ZC9FILVaovpdCtBkhwJxUpHdbc4E5LsHeQADhqeQP5FB04x1gs7F2PDACQCQin8zpRXisyLBLFOKQnbOTiSkBZLXiUkpdc6liqVBioEBKowTKTXKtVZpdlnLyLSn0Ly-lmChW-JUBfKgMEfomHAIAb89AZ4oZcwWFgBYTUABB6xrPXepMGq9+OZUJBuhdYTVES9k6vJQamBRqo1evAj6jMTyrB-Ojfm2Nmkk0EvAHal13L9CVpBSsvlgrhVpGZQARyoCcdg0hwCAG7lQAkcavFlfK41PhO3dsWdi+NGrf7EsiRS7QqE9UUqpTSxkHau0QukJa8dW6e1so5ewFddam3HpbQfY4RgJACAAELMC4rBKg7Aq4eHAIACnUEDQBPoBQAb6aAEwFQAnBaADtjQAPApEEIIALQVADQcoAcfjAAndubZ0V6b33sfUYZ9r6HLRPmQ8XpizlmrPWfodDmHKjquWESnZC6cOHIyVk8OpGX3V3AEk3u7B+4CF7NEtdGBtg3p2OBe4nBhY0CeOANhKwa1r30XJHMzqF7iIHjSOgz8frMBk-YuS9J10eBQ8MNDT7mMcFVvpu9D6jNYZ4KJuO1a94CFMEAA)

## **é€’å½’å¤ç”¨åšå¾ªç¯**

åœ¨ TypeScript ç±»å‹ç¼–ç¨‹ä¸­ï¼Œé‡åˆ°æ•°é‡ä¸ç¡®å®šé—®é¢˜æ—¶ï¼Œå°±è¦æ¡ä»¶åå°„çš„æƒ³åˆ°é€’å½’ï¼Œæ¯æ¬¡åªå¤„ç†ä¸€ä¸ªç±»å‹ï¼Œå‰©ä¸‹çš„æ”¾åˆ°ä¸‹æ¬¡é€’å½’ï¼Œç›´åˆ°æ»¡è¶³ç»“æŸæ¡ä»¶ï¼Œå°±å¤„ç†å®Œäº†æ‰€æœ‰çš„ç±»å‹ã€‚

æ¯”å¦‚æŠŠé•¿åº¦ä¸ç¡®å®šçš„å­—ç¬¦ä¸²è½¬ä¸ºè”åˆç±»å‹ï¼š

```ts
type StringToUnion<Str extends string> =
  Str extends `${infer First}${infer Rest}`
    ? First | StringToUnion<Rest>
    : never;
```

![image-20221014115302944](./assets/image-20221014115302944.png)

```ts
// é€’å½’å¤ç”¨åšå¾ªç¯

// Promise çš„é€’å½’å¤ç”¨
// DeepPromiseValueType  å®ç°ä¸€ä¸ªæå–ä¸ç¡®å®šå±‚æ•°çš„ Promise ä¸­çš„ value ç±»å‹çš„é«˜çº§ç±»å‹ã€‚

type DeepPromiseValueType<P extends Promise<unknown>> = P extends Promise<
  infer ValueType
>
  ? ValueType extends Promise<unknown>
    ? DeepPromiseValueType<ValueType>
    : ValueType
  : never;

type test = Promise<Promise<Promise<string>>>;
type DeepPromiseValueTypeRes = DeepPromiseValueType<test>;

// ç®€åŒ–
type DeepPromiseValueType2<T> = T extends Promise<infer ValueType>
  ? DeepPromiseValueType2<T>
  : T;
type test2 = Promise<number>;
type DeepPromiseValueType2Res = DeepPromiseValueType<test2>;

// æ•°ç»„ç±»å‹çš„é€’å½’
// ReverseArr æŠŠtype arr = [1,2,3,4,5]; å˜æˆ type arr = [5,4,3,2,1];

type ReverseArr<Arr extends unknown[]> = Arr extends [
  infer First,
  ...infer Rest
]
  ? [...ReverseArr<Rest>, First]
  : Arr;
type ReverseArrRes = ReverseArr<[1, 2, 3, 4, 5]>;

// Includes æ¯”å¦‚æŸ¥æ‰¾ [1, 2, 3, 4, 5] ä¸­æ˜¯å¦å­˜åœ¨ 4ï¼Œæ˜¯å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚
type IsEqual<A, B> = (A extends B ? true : false) &
  (B extends A ? true : false);
type Includes<Arr extends unknown[], FindItem> = Arr extends [
  infer First,
  ...infer Rest
]
  ? IsEqual<First, FindItem> extends true
    ? true
    : Includes<Rest, FindItem>
  : false;

type IncludesRe = Includes<[1, 2, 3, 4], 4>;

// RemoveItem å¯ä»¥æŸ¥æ‰¾è‡ªç„¶å°±å¯ä»¥åˆ é™¤ï¼Œåªéœ€è¦æ”¹ä¸‹è¿”å›ç»“æœï¼Œæ„é€ ä¸€ä¸ªæ–°çš„æ•°ç»„è¿”å›ã€‚
type RemoveItem<
  Arr extends unknown[],
  Item,
  Result extends unknown[] = []
> = Arr extends [infer First, ...infer Rest]
  ? IsEqual<First, Item> extends true
    ? // å¦‚æœå­˜åœ¨,å°±ä¸å°†firstæ”¾å…¥result
      RemoveItem<Rest, Item, Result>
    : // å¦‚æœä¸å­˜åœ¨, å°±æ”¾å…¥
      RemoveItem<Rest, Item, [...Result, First]>
  : Result;

type RemoveItemRes = RemoveItem<[1, 2, 3, 4, 2, 2], 2>;

// å­—ç¬¦ä¸²ç±»å‹é€’å½’
// ReplaceAll
type ReplaceAll<
  Str extends string,
  From extends string,
  To extends string
> = Str extends `${infer Left}${From}${infer Right}`
  ? `${Left}${To}${ReplaceAll<Right, From, To>}`
  : Str;

type ReplaceAllRes = ReplaceAll<"vvv_vvv_vvv", "vvv", "123">;

// StringToUnion
type StringToUnion<Str extends string> =
  Str extends `${infer First}${infer Rest}`
    ? First | StringToUnion<Rest>
    : never;
type StringToUnionRes = StringToUnion<"hello">;

// ReverseStr
type ReverseStr<Str extends string> = Str extends `${infer First}${infer Rest}`
  ? `${ReverseStr<Rest>}${First}`
  : Str;
type ReverseStrRes = ReverseStr<"hello">;

// å¯¹è±¡ç±»å‹çš„é€’å½’ -- æ•°é‡ï¼ˆå±‚æ•°ï¼‰ä¸ç¡®å®šï¼Œç±»å‹ä½“æ“ä¸­åº”è¯¥è‡ªç„¶çš„æƒ³åˆ°é€’å½’ã€‚

type DeepReadonly<Obj extends Record<string, any>> = Obj extends any
  ? {
      readonly [Key in keyof Obj]: Obj[Key] extends object
        ? Obj[Key] extends Function
          ? Obj[Key]
          : DeepReadonly<Obj[Key]>
        : Obj[Key];
    }
  : never;

type obj = {
  a: {
    b: {
      c: {
        f: () => "dong";
        d: {
          e: {
            vvv: string;
          };
        };
      };
    };
  };
};

type DeepReadonlyResult = DeepReadonly<obj>;
```

[**é€’å½’å¤ç”¨åšå¾ªç¯**](https://www.typescriptlang.org/play?#code/FAehAJCQEwlfUWE1ApXQWgqCr9Q9c7FBACgJwPYC2AlgM4Cm4gIW4wKbgAiZZADroaWQGoCGANgK5kAKgE9mFcIDztQA3OgADlAVHKAF40BryoFg5QHYegLO1AQjqAHU0rg2xcuEC0cgYBufQeEDePoGj1SoA2swOV+DwEAMGAC5iKjFkYcPALCvgA8WOBkAB5eZAB2ACYkhvjGZGH88QDW8XgA7vEAfEXgALyGUbEJyeCp7ORhRPEAZmQ44MGCouKlAPzAdUNDXaHiVXFJKYGNWbkFxeB94IPDQ-6saUHWYxmjPWSlAFydOwfgJ-FkFu3evuBxJF7l9ekRW40zGU84zQDmJSKwB84w2X32vgASmQUhUwR8uGdwo8vEC6IAA70AaMrA+7whqIkIHABMYSEpQqQgmNWmCKarXap0Jvn6DCYm3xEPEJLJF3AQhx4xRRJeXzC8X4BAARu1SgK-GzwUiudDYayAgjORkhWi6LpACN+Dmo0Do0JuOHIAEEcB1AFFGIIo3GtLwA2gBGAA0RPdAGZ3QAWd0AVgAugBucCADeVAAhGD3ujo6FWdgf9Ps97tdYbu41N7Ut1rCVo6MUmtTmeUKzuD5PAhapU3AzuabQ6ADEiOavO7wAA6XtNhkqrzBpYN3vdnPmsiFsKDopdtsd4cnQty8ATvM4FUvddT-NutO+gMhtFgcAASXiAGMBIkYeBACvWgCDNQCn5oA-IwbHvAXvAvvAAfAIZmIA9GaAGQqgAa2oAFOp-oAMP9AYAjDqACvxgB7ag8OCCNBIGAJhKyHgC0fDkJ49rniQACiACO-B8AWXYAELVgAFBada1DRI5eGhFAnHhvDkAAlOAABk4D0axxbUjWbEcby3F8aGq4Xte-C3iQBZOmJ9Zlgslbzs0iRnnEBDVrW6m1I29Ktu2TxdmO-YdIOw4DMR5GUbwYQLlZ4Btkk+lkIZzEpOxNjLIFnF1ApN4wjOMKdp5uk+YZgxcfhZAYLG4zhUpMLQi8GXKWE+5fl2v5+sGXZ+rKgyntCBB4Dc8XgIA98qAKdyb6AFeBgBsjnBzWAARKgAmadBgBXyoAAOmAIGRgCcpoA0HLIYAy36ADnm0GACHmgAECQogANppQ+rIYR9zVbVZDxWEqx1MZ1QaTk5bxNpKzDPFXZHWuML8LwzwmSkmkVsOibBsARlqadpm2bFHbWX25kPU831rEMyxnqRFFUe5MXxaUr2oYI91Q0Mp6PrNkHunBqiAGA6LSWV4gB8poApoo4I9z0Y5jyy7XVBlRR5t3g09qJ01D2OzaoePgHBlNc2sJyM-tzODl2bPOmOKoczpi5ApjvJy89cmrmL8VbhUmvM-uXqHmmRKlV+J4QIA6tqAGTegBMcg4MAmiwvDcJeU68LwGuO87ruufdADK7H+eAPz-HdwwtmkgfB-Efyh0MQh4JH7H-D9Lz+0W-0pAABgAJAA3oDAAyZAtF4AC+efh4Q5f52DkJEH8AAWZeZyOOe50XJfV-H1fQswTsuxabszvXTfzmkXbx0Upctycafq0Rvf9972sPX3XuD65ADkFg7wA+jvFj7zvm9dtvx+n66RLepvOqnmn-zxwAqvERB4PEq739HT8v2-YRp4nvxo7Vn-qjNugNEbV0BoOaeI5EbgAAD7gE-n8b+r94gs1RLyK4ZoP5Jy-ngZ+aCV7INQb-TeDcyBuzwDfDADszTkDTh7ehZA05-wDqjKOAJU7sIzuAMBYMIF5ygdFGByw247lYbOauECZ5IPYkw3MLD2IrwkexMI5DKG8GobfCAgBP7UAIYxhoYDgAALQmPALoQA84mAAh-vQgBIf40JoaCDhADK8oAWZNTCABS9QAp9EdUoIAZ4NAAMSjATwq4NjQm4IkN+vARBhAAPKSgAFaB2hJePAOBEhhE4V2bg8QRAlHKPdBJyTUa5JEMLZYudhbDGppE6JIgGwAGkyANOaOAbILS8AtHAMU4MRxqmY2Kc6ZpIhhyozwEksgl4vADOVnUZYQyRljN4S2LI0y0GzLmcMBZSThktOHJsrZdQTjhLIHU+IMT4m7KWUrI5ysTiLP2cLUuwtLjXHaPPe4EzkkVCqcMbgJw-mY0lICzZl5QV3OGC0E49F+JlFKJvKJ0cT6HKGIkCFkKoZkAxZi5WB8TicNRVDF5uLwAkqOeS4l90XkvLCWyCJSKYmq2eHCelZzGWxO+UUUMQA)

## **æ•°ç»„é•¿åº¦åšè®¡æ•°**

TypeScript ç±»å‹ç³»ç»Ÿæ²¡æœ‰åŠ å‡ä¹˜é™¤è¿ç®—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥æ„é€ ä¸åŒçš„æ•°ç»„å†å– length æ¥å¾—åˆ°ç›¸åº”çš„ç»“æœã€‚è¿™æ ·å°±æŠŠæ•°å€¼è¿ç®—è½¬ä¸ºäº†æ•°ç»„ç±»å‹çš„æ„é€ å’Œæå–ã€‚

æ¯”å¦‚å®ç°å‡æ³•ï¼š

```ts
type BuildArray<
  Length extends number,
  Ele = unknown,
  Arr extends unknown[] = []
> = Arr["length"] extends Length ? Arr : BuildArray<Length, Ele, [...Arr, Ele]>;

type Subtract<
  Num1 extends number,
  Num2 extends number
> = BuildArray<Num1> extends [...arr1: BuildArray<Num2>, ...arr2: infer Rest]
  ? Rest["length"]
  : never;
```

![image-20221014115410632](./assets/image-20221014115410632.png)

## **è”åˆåˆ†æ•£å¯ç®€åŒ–**

TypeScript å¯¹è”åˆç±»å‹åšäº†ç‰¹æ®Šå¤„ç†ï¼Œå½“é‡åˆ°å­—ç¬¦ä¸²ç±»å‹æˆ–è€…ä½œä¸ºç±»å‹å‚æ•°å‡ºç°åœ¨æ¡ä»¶ç±»å‹å·¦è¾¹çš„æ—¶å€™ï¼Œä¼šåˆ†æ•£æˆå•ä¸ªçš„ç±»å‹ä¼ å…¥åšè®¡ç®—ï¼Œæœ€åæŠŠè®¡ç®—ç»“æœåˆå¹¶ä¸ºè”åˆç±»å‹ã€‚

```ts
type UppercaseA<Item extends string> = Item extends "a"
  ? Uppercase<Item>
  : Item;
```

![image-20221014115652971](./assets/image-20221014115652971.png)

è¿™æ ·è™½ç„¶ç®€åŒ–äº†ç±»å‹ç¼–ç¨‹ï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä¸€äº›è®¤çŸ¥è´Ÿæ‹…ã€‚

æ¯”å¦‚è”åˆç±»å‹çš„åˆ¤æ–­æ˜¯è¿™æ ·çš„ï¼š

```ts
type IsUnion<A, B = A> = A extends A ? ([B] extends [A] ? false : true) : never;
```

è”åˆç±»å‹åšä¸ºç±»å‹å‚æ•°ç›´æ¥å‡ºç°åœ¨æ¡ä»¶ç±»å‹å·¦è¾¹çš„æ—¶å€™å°±ä¼šè§¦å‘ distributive ç‰¹æ€§ï¼Œè€Œä¸æ˜¯ç›´æ¥å‡ºç°åœ¨å·¦è¾¹çš„æ—¶å€™ä¸ä¼šã€‚

æ‰€ä»¥ï¼Œ A æ˜¯å•ä¸ªç±»å‹ã€B æ˜¯æ•´ä¸ªè”åˆç±»å‹ã€‚é€šè¿‡æ¯”è¾ƒ A å’Œ B æ¥åˆ¤æ–­è”åˆç±»å‹ã€‚

## **ç‰¹æ®Šç‰¹æ€§è¦è®°æ¸…**

ä¼šäº†æå–ã€æ„é€ ã€é€’å½’ã€æ•°ç»„é•¿åº¦è®¡æ•°ã€è”åˆç±»å‹åˆ†æ•£è¿™ 5 ä¸ªå¥—è·¯ä»¥åï¼Œå„ç§ç±»å‹ä½“æ“éƒ½èƒ½å†™ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç‰¹æ®Šç±»å‹çš„åˆ¤æ–­éœ€è¦æ ¹æ®å®ƒçš„ç‰¹æ€§æ¥ï¼Œæ‰€ä»¥è¦é‡ç‚¹è®°ä¸€ä¸‹è¿™äº›ç‰¹æ€§ã€‚

æ¯”å¦‚ any å’Œä»»ä½•ç±»å‹çš„äº¤å‰éƒ½ä¸º anyï¼Œå¯ä»¥ç”¨æ¥åˆ¤æ–­ any ç±»å‹ï¼š`

```ts
type IsAny<T> = "vvv" extends "code" & T ? true : false;
```

![image-20221014115851446](./assets/image-20221014115851446.png)

æ¯”å¦‚ç´¢å¼•ä¸€èˆ¬æ˜¯ stringï¼Œè€Œå¯ç´¢å¼•ç­¾åä¸æ˜¯ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªæ¥è¿‡æ»¤æ‰å¯ç´¢å¼•ç­¾åï¼š

```ts
type RemoveIndexSignature<Obj extends Record<string, any>> = {
  [Key in keyof Obj as Key extends `${infer Str}` ? Str : never]: Obj[Key];
};
```

![image-20221014120056764](./assets/image-20221014120056764.png)

## **åŸºç¡€æ‰å®å¥—è·¯ç†Ÿï¼Œç±»å‹ä½“æ“å¯é€šå…³**

åŸºç¡€æŒ‡çš„æ˜¯ TypeScript ç±»å‹ç³»ç»Ÿä¸­çš„å„ç§ç±»å‹ï¼Œä»¥åŠå¯ä»¥å¯¹å®ƒä»¬åšçš„å„ç§ç±»å‹è¿ç®—é€»è¾‘ï¼Œè¿™æ˜¯ç±»å‹ç¼–ç¨‹çš„åŸææ–™ã€‚

ä½†æ˜¯åªæ˜¯ä¼šäº†åŸºç¡€ä¸æ‡‚ä¸€äº›å¥—è·¯ä¹Ÿå¾ˆéš¾åšå¥½ç±»å‹ç¼–ç¨‹ï¼Œæ‰€ä»¥è¦ç†Ÿæ‚‰ä¸Šé¢ 6 ç§å¥—è·¯ã€‚

åŸºç¡€æ‰å®ã€å¥—è·¯ä¹Ÿç†Ÿäº†ä¹‹åï¼Œå„ç§ç±»å‹ç¼–ç¨‹é—®é¢˜éƒ½å¯ä»¥æå®šï¼Œä¹Ÿå°±æ˜¯â€œé€šå…³â€ã€‚

## **å‚è€ƒé“¾æ¥**

[[TypeScript ç±»å‹ä½“æ“é€šå…³ç§˜ç±](https://juejin.cn/book/7047524421182947366)]

<br/>
<hr />

â­ï¸â­ï¸â­ï¸ å¥½å•¦ï¼ï¼ï¼æœ¬æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸå•¦ã€‚â­ï¸â­ï¸â­ï¸

âœ¿âœ¿ ãƒ½(Â°â–½Â°)ãƒ âœ¿

æ’’èŠ± ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸
