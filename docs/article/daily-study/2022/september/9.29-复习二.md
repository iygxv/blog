# 9.29-复习二

## **HTTP的缓存控制**

max-age是 HTTP 缓存控制最常用的属性，此外在响应报文里还可以用其他的属性来更精确地指示浏览器应该如何使用缓存:

- no_store(**不允许缓存**)
- no_cache(**可以缓存**，但在使用之前必须要去服务器验证是否过期，是否有最新的版本)
- must-revalidate(意思是如果缓存不过期就可以继续使用，但过期了如果还想用就必须去服务器验证)



**客户端请求字段**

最常用的是**if-Modified-Since**和**If-None- Match**这两个。

需要第一次的响应报文预先提供**Last-modified**和**ETag**，然后第二次请求时就可以带上缓存里的原值，验证资源是否是最新的。

**服务端返回字段**

Last-modified(**文件的最后修改时间**)

ETag(**资源的一个唯一标识**)

## **HTTPS是什么? SSL/TLS又是什么?**

HTTPS 其实是一个非常简单的协议,面规定了**新的协议名https，默认端口号 443**

HTTPS 把 HTTP 下层的传输协议由 TCP/IP 换成了 SSL/TLS，由**HTTP over TCP/IP**变成了**HTTP over SSL/TLS**，让 HTTP 运行在了安全的 SSL/TLS 协议上，收发报文不再使用 Socket API， 而是调用专门的安全接口。

### **SSL/TLS**

SSL 即安全套接层(Secure Sockets Layer)，在 OSI 模型中处于第 5 层(会话层)，由网景公司于 1994 年发明，有 v2 和 v3 两个版本，而 v1 因为有严重的缺陷从未公开过。

SSL 发展到 v3 时已经证明了它自身是一个非常好的安全通信协议，于是互联网工程组 IETF `在 1999 年`把它改名为 TLS(传输层安全，Transport Layer Security)，正式标准化，版本号从 1.0 重新算起，所以` TLS1.0 实际上就是 SSLv3.1`。

到今天 TLS 已经发展出了三个版本，分别是 2006 年的 1.1、2008 年的 1.2 和去年 (2018)的 1.3，每个新版本都紧跟密码学的发展和互联网的现状，持续强化安全和性 能，已经成为了信息安全领域中的权威标准。

目前应用的`最广泛的 TLS 是 1.2`，而之前的协议(TLS1.1/1.0、SSLv3/v2)都已经被认为是不安全的，各大浏览器即将在 2020 年左右停止支持，所以接下来的讲解都针对的是 TLS1.2。

TLS 由记录协议、握手协议、警告协议、变更密码规范协议、扩展协议等几个子协议组成， 综合使用了对称加密、非对称加密、身份认证等许多密码学前沿技术。

## **对称加密与非对称加密**

- `对称加密只使用一个密钥`，运算速度快，密钥必须保密，`无法做到安全的密钥交换`，常用的有 AES 和 ChaCha20
- `非对称加密使用两个密钥:公钥和私钥，公钥可以任意分发而私钥保密，解决了密钥交换问题但速度慢，常用的有 RSA 和 ECC`
- 把对称加密和非对称加密结合起来就得到了又好又快的混合加密，也就是` TLS 里使用的加密方式(混合加密)`
  - 在通信刚开始的时候使用非对称算法，比如 RSA、ECDHE，首先解决密钥交换的问题。
  - 然后用随机数产生对称算法使用的**会话密钥**(session key)，再用公钥加密。因为会话密钥很短，通常只有 16 字节或 32 字节，所以慢一点也无所谓。
  - 对方拿到密文后用私钥解密，取出会话密钥。这样，双方就实现了对称密钥的安全交换，后续就不再使用非对称加密，全都使用对称加密。

## **HTTP/2.0** 

- 二进制协议，不再是纯文本(`二进制协议`)
- 可发起多个请求，废弃了 1.1 里的管道(`多路复用`)
- 使用专用算法压缩头部，减少数据传输量(`头部压缩, 使得可以在header带更多数据了`)
- 允许服务器主动向客户端推送数据(`服务器主动push数据到客户端`)
- 增强了安全性，事实上要求加密通信(`安全性`)

