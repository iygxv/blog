---
sidebar:
 title: h5é¡¹ç›®é‡åˆ°çš„é—®é¢˜
 step: 1
 isTimeLine: true
title: h5é¡¹ç›®é‡åˆ°çš„é—®é¢˜
tags:
 - é¡¹ç›®
categories:
 - é¡¹ç›®
---


# å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜

## ç§»åŠ¨ç«¯å…¼å®¹é—®é¢˜

### 1.ä¸Šä¼ éŸ³é¢‘çš„å…¼å®¹é—®é¢˜
### acceptåªè®¾ç½®`audio/*`,iosæ— æ³•é€‰å–éŸ³é¢‘æ–‡ä»¶
å®éªŒå‘ç°è®¾ç½® `accept="audio/*, .mp3, .wma, .amr, .wav, .m4a"`ï¼Œå¯ä»¥å…¼å®¹ioså’Œå®‰å“é€‰å–è¿™äº›éŸ³é¢‘æ–‡ä»¶(wmaè¿˜æ˜¯æ— æ³•é€‰å–)

### æ’­æ”¾å…¼å®¹æƒ…å†µ
åœºæ™¯ï¼šé€šè¿‡`input`æ¡†é€‰å–æœ¬åœ°éŸ³é¢‘æ–‡ä»¶åå¾—åˆ°çš„`file`å¯¹è±¡ï¼Œ`URL.createObjectURL(file)`å¾—åˆ°æœ¬åœ°æ–‡ä»¶æ’­æ”¾åœ°å€
æ’­æ”¾å™¨ï¼šåŸç”Ÿ`audio`æ ‡ç­¾

mp3æ–‡ä»¶ï¼šå®‰å“é€‰å–çš„æ–‡ä»¶å¿…é¡»å¸¦æœ‰æ‰©å±•åï¼Œå¦åˆ™`file.type` ä¸ºç©ºã€`file.name`æ˜¯æ–‡ä»¶å‘½æœ¬èº«ï¼ˆæ²¡æœ‰æ‰©å±•åï¼‰
m4aæ–‡ä»¶ï¼šï¼Œå®‰å“ã€ioså‡ä¸æ”¯æŒæ’­æ”¾ï¼Œæœ‰å¯èƒ½æ˜¯`URL.createObjectURL(file)`è½¬æ¢åé€ æˆçš„é—®é¢˜
```html
<!--å®‰å“å¯ä»¥æ’­æ”¾è¿œç«¯çš„m4aæ–‡ä»¶ï¼Œiosä¸æ”¯æŒ-->
<audio class="audio-box" controls autoplay crossorigin="anonymous">
   <source
      src="xxx.m4a"
      type="audio/mp4"
    />
</audio>
```

- wmaæ–‡ä»¶ï¼š iosæ— æ³•é€‰å–è¯¥ç±»å‹æ–‡ä»¶ï¼Œï¼ˆacceptå±æ€§è®¾ç½®äº†æ— æ•ˆï¼Œæš‚æ—¶ä¸çŸ¥é“åŸå› ï¼‰

### æ–‡ä»¶.amr ä¸ .wavæš‚æ—¶æ²¡æœ‰é‡åˆ°å…¼å®¹çš„é—®é¢˜
### ç§»åŠ¨ç«¯ç›¸å…³
[æ€»ç»“ç§»åŠ¨ç«¯H5å¼€å‘å¸¸ç”¨æŠ€å·§](https://juejin.cn/post/6844904066301050893#heading-4)
[ç§»åŠ¨ç«¯é€‚é…çš„5ç§æ–¹æ¡ˆ](https://juejin.cn/post/6953091677838344199)

## ç»„ä»¶æ›´æ–°é—®é¢˜
åœ¨ä¸€æ¬¡åšåŠ¨ç”»è·³è·ƒçš„æ—¶å€™ï¼Œ æ¯æ¬¡è·³è·ƒéœ€è¦ä¸ºç©º
```javascript
el.style.animation = ''
el.style.animationFillMode = ''
```
ä½†æ˜¯ğŸˆ¶éœ€è¦é‡æ–°è®¾ç½®å›æ¥ï¼Œè®©å…¶å†æ¬¡è·³è·ƒ
```javascript
el.style.animation = 'jump 1s linear'
el.style.animationFillMode = 'both'
```
è¿™é‡Œæœ‰ä¸€ä¸ªå‘
```javascript
el.style.animation = ''
el.style.animationFillMode = ''
console.log(123)
el.style.animation = 'jump 1s linear'
el.style.animationFillMode = 'both'
```
è¿™æ ·å­æ“ä½œä¼šè·³è·ƒæ­£å¸¸ï¼Œ è§¦å‘æ›´æ–°æ ·å¼2æ¬¡ï¼Œ å› ä¸ºconsole.logå…·æœ‰debuggerç±»ä¼¼çš„åŠŸèƒ½ï¼Œ è®©ä¸‹é¢å†…å®¹æš‚åœæ‰§è¡Œ
ä½†æ˜¯ï¼Œ å¦‚æœå»æ‰console.logï¼Œä¹Ÿå°±æ˜¯
```javascript
el.style.animation = ''
el.style.animationFillMode = ''

el.style.animation = 'jump 1s linear'
el.style.animationFillMode = 'both'
```
è¿™æ ·å­çš„è¯ï¼Œè·³è·ƒå¼‚å¸¸ï¼Œ å› ä¸ºåªä¼šè§¦å‘ä¸€æ¬¡æ ·å¼æ›´æ–°ï¼Œ å¦‚æœæ²¡æœ‰æ¸…ç©ºè¿™ä¸ªanimationï¼Œ æ ·å¼å°†ä¸å‘ç”Ÿæ”¹å˜ï¼Œ é¡µé¢ä¸ä¼šè§¦å‘æ›´æ–°ã€‚
### æˆ‘çš„åšæ³•
å› ä¸ºæˆ‘ä»¬è¦è§¦å‘æ›´æ–°ï¼Œ ä½¿animationæ ·å¼å‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤, æ¯æ¬¡éœ€è¦è·³è·ƒçš„æ—¶å€™ï¼Œ è®©åŠ¨ç”»åå­—å‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿animationæ ·å¼å‘ç”Ÿå˜åŒ–ï¼Œå³å¦‚ä¸‹ä»£ç å±•ç¤ºï¼š
```javascript
// ç”¨æ—¶é—´æ“ä¿è¯æ¯æ¬¡çš„åŠ¨ç”»åéƒ½ä¼šä¸é‡å¤
const animationName = `animation-${+ new Date()}` 

el.style.animation = `${animationName} 1s linear`
```
## ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†
```javascript
const task1 = () => {
  console.log('task1')
}
const task2 = () => {
  console.log('task2')
}
const task3 = () => {
  console.log('task3')
}
const task4 = () => {
  console.log('task4')
}
function cb() {
  console.log('æœ€åæ‰æ‰§è¡Œçš„å›è°ƒ')
}

const taskQueue = []
const maxCount = 2 // æœ€å¤§è¿è¡Œæ•°é‡
let runningCount = 0 // æ­£åœ¨è¿è¡Œçš„æ•°é‡
// æ·»åŠ ä»»åŠ¡
function addTask(fn, time, isFinish) {
  const task = () => {
    return new Promise((resolve, reject) => {
      setTimeout(() => {
        fn()
        resolve(isFinish)
      }, time)
    })
  }
  taskQueue.push(task)
}

// æ‰§è¡Œä»»åŠ¡
function executeTask(callback) {
  if (!taskQueue.length || runningCount > 2) return
  runningCount++ // æ¯æ‰§è¡Œä¸€ä¸ªä»»åŠ¡++
  const task = taskQueue.shift() // å–å‡ºä»»åŠ¡, taskæ˜¯ä¸€ä¸ªå‡½æ•°(shiftåˆ é™¤æœ€å‰é¢ä¸€ä¸ª, å¹¶è¿”å›åˆ é™¤çš„å…ƒç´ )
  task().then(isFinish => {
    // .thenæ‹¿åˆ°æ˜¯å¦ç»“æŸ
    if (isFinish) {
      // ç»“æŸåæˆ‘ä»¬æ‰æ‰§è¡Œå›è°ƒ
      callback()
      return
    }
    // thenå,è¯´æ˜æ‰§è¡Œå®Œæ¯• runningCount --
    runningCount--
    executeTask(callback) // æ²¡ç»“æŸ, æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡
  })
}

function collectTask() {
  addTask(task1, 1000, false)
  addTask(task2, 3000, false)
  addTask(task3, 1000, false)
  addTask(task4, 5000, true)
}
// æ”¶é›†ä»»åŠ¡
collectTask()

// maxCount === 2
for (let i = 0; i < maxCount; i++) {
  console.log(123)
  executeTask(cb)
}
```
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæ¥å¹¶è¡Œå¤„ç†è‡ªå·±çš„é€»è¾‘


<br/>
<hr />

â­ï¸â­ï¸â­ï¸å¥½å•¦ï¼ï¼ï¼æœ¬æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸå•¦ã€‚â­ï¸â­ï¸â­ï¸

âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿

æ’’èŠ± ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸
